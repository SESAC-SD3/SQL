
## 1. 엔티티 상세 분석

### 1.1. Users (사용자)

**설명:** 인스타그램 사용자 정보를 저장하는 테이블

| 속성명 | 데이터 타입 | NULL 허용 | 제약조건 | 설명 |
|--------|------------|----------|---------|------|
| user_id | INT | NO | PK, AUTO_INCREMENT | 사용자 고유 ID |
| username | VARCHAR(50) | NO | UNIQUE | 사용자명 (@chulsoo) |
| email | VARCHAR(100) | NO | UNIQUE | 이메일 주소 |
| password_hash | VARCHAR(255) | NO | - | 비밀번호 해시 |
| full_name | VARCHAR(100) | YES | - | 실명 |
| profile_image_url | VARCHAR(255) | YES | - | 프로필 이미지 URL |
| created_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP | 가입일시 |
| updated_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 수정일시 |

**비즈니스 규칙:**
- username은 영문, 숫자, 언더스코어만 허용
- email은 유효한 이메일 형식
- username은 3자 이상 50자 이하

---

### 1.2. Posts (게시물)

**설명:** 사용자가 작성한 게시물 정보를 저장하는 테이블

| 속성명 | 데이터 타입 | NULL 허용 | 제약조건 | 설명 |
|--------|------------|----------|---------|------|
| post_id | INT | NO | PK, AUTO_INCREMENT | 게시물 고유 ID |
| user_id | INT | NO | FK → users.user_id | 작성자 ID |
| content | TEXT | YES | - | 게시물 본문 내용 |
| created_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP | 작성일시 |
| updated_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 수정일시 |

**비즈니스 규칙:**
- 한 게시물은 최소 1개의 미디어를 가져야 함 (애플리케이션 레벨 검증)
- 게시물 삭제 시 관련 미디어, 댓글, 좋아요도 함께 삭제 (CASCADE)

---

### 1.3. Media (미디어)

**설명:** 게시물에 첨부된 사진/동영상 정보를 저장하는 테이블

| 속성명 | 데이터 타입 | NULL 허용 | 제약조건 | 설명 |
|--------|------------|----------|---------|------|
| media_id | INT | NO | PK, AUTO_INCREMENT | 미디어 고유 ID |
| post_id | INT | NO | FK → posts.post_id | 게시물 ID |
| media_url | VARCHAR(255) | NO | - | 미디어 파일 URL |
| media_type | ENUM('IMAGE', 'VIDEO') | NO | - | 미디어 타입 |
| media_order | TINYINT | NO | DEFAULT 1 | 미디어 순서 (1~10) |
| created_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP | 업로드일시 |

**비즈니스 규칙:**
- 한 게시물당 최대 10개의 미디어 (애플리케이션 레벨 검증)
- media_order는 1 이상 10 이하
- 게시물 삭제 시 미디어도 함께 삭제 (CASCADE)

---

### 1.4. Comments (댓글)

**설명:** 게시물에 작성된 댓글 정보를 저장하는 테이블

| 속성명 | 데이터 타입 | NULL 허용 | 제약조건 | 설명 |
|--------|------------|----------|---------|------|
| comment_id | INT | NO | PK, AUTO_INCREMENT | 댓글 고유 ID |
| post_id | INT | NO | FK → posts.post_id | 게시물 ID |
| user_id | INT | NO | FK → users.user_id | 작성자 ID |
| content | VARCHAR(500) | NO | - | 댓글 내용 |
| created_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP | 작성일시 |
| updated_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 수정일시 |

**비즈니스 규칙:**
- content는 최소 1자 이상
- 게시물 삭제 시 댓글도 함께 삭제 (CASCADE)

---

### 1.5. Likes (좋아요)

**설명:** 게시물에 대한 좋아요 정보를 저장하는 테이블

| 속성명 | 데이터 타입 | NULL 허용 | 제약조건 | 설명 |
|--------|------------|----------|---------|------|
| like_id | INT | NO | PK, AUTO_INCREMENT | 좋아요 고유 ID |
| post_id | INT | NO | FK → posts.post_id | 게시물 ID |
| user_id | INT | NO | FK → users.user_id | 좋아요한 사용자 ID |
| created_at | TIMESTAMP | NO | DEFAULT CURRENT_TIMESTAMP | 좋아요 누른 일시 |

**비즈니스 규칙:**
- 한 사용자는 같은 게시물에 한 번만 좋아요 가능
- 게시물 삭제 시 좋아요도 함께 삭제 (CASCADE)
- 사용자 삭제 시 좋아요도 함께 삭제 (CASCADE)

---

## 2. 엔티티 간 관계 분석

### 2.1. Users와 Posts (1:N)

**관계:** 한 사용자는 여러 게시물을 작성할 수 있다

```
Users (1) ──────< (N) Posts
user_id (PK)        user_id (FK)
```

**카디널리티:**
- 최소: 한 사용자는 0개의 게시물을 가질 수 있음 (선택)
- 최대: 한 사용자는 무제한 게시물을 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (사용자 삭제 시 게시물도 삭제)
- ON UPDATE: CASCADE (user_id 변경 시 반영)

---

### 2.2. Posts와 Media (1:N)

**관계:** 한 게시물은 여러 미디어를 가질 수 있다

```
Posts (1) ──────< (N) Media
post_id (PK)        post_id (FK)
```

**카디널리티:**
- 최소: 한 게시물은 최소 1개의 미디어를 가져야 함 (필수)
- 최대: 한 게시물은 최대 10개의 미디어를 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (게시물 삭제 시 미디어도 삭제)
- ON UPDATE: CASCADE

---

### 2.3. Users와 Comments (1:N)

**관계:** 한 사용자는 여러 댓글을 작성할 수 있다

```
Users (1) ──────< (N) Comments
user_id (PK)        user_id (FK)
```

**카디널리티:**
- 최소: 한 사용자는 0개의 댓글을 가질 수 있음 (선택)
- 최대: 한 사용자는 무제한 댓글을 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (사용자 삭제 시 댓글도 삭제)
- ON UPDATE: CASCADE

---

### 2.4. Posts와 Comments (1:N)

**관계:** 한 게시물은 여러 댓글을 가질 수 있다

```
Posts (1) ──────< (N) Comments
post_id (PK)        post_id (FK)
```

**카디널리티:**
- 최소: 한 게시물은 0개의 댓글을 가질 수 있음 (선택)
- 최대: 한 게시물은 무제한 댓글을 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (게시물 삭제 시 댓글도 삭제)
- ON UPDATE: CASCADE

---

### 2.5. Users와 Likes (1:N)

**관계:** 한 사용자는 여러 게시물에 좋아요를 누를 수 있다

```
Users (1) ──────< (N) Likes
user_id (PK)        user_id (FK)
```

**카디널리티:**
- 최소: 한 사용자는 0개의 좋아요를 가질 수 있음 (선택)
- 최대: 한 사용자는 무제한 좋아요를 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (사용자 삭제 시 좋아요도 삭제)
- ON UPDATE: CASCADE

---

### 2.6. Posts와 Likes (1:N)

**관계:** 한 게시물은 여러 사용자에게 좋아요를 받을 수 있다

```
Posts (1) ──────< (N) Likes
post_id (PK)        post_id (FK)
```

**카디널리티:**
- 최소: 한 게시물은 0개의 좋아요를 가질 수 있음 (선택)
- 최대: 한 게시물은 무제한 좋아요를 가질 수 있음

**참조 무결성:**
- ON DELETE: CASCADE (게시물 삭제 시 좋아요도 삭제)
- ON UPDATE: CASCADE

---

## 3. 개념적 ERD

### 3.1. ERD란?

**ERD (Entity-Relationship Diagram)**는 데이터베이스의 구조를 시각적으로 표현하는 다이어그램입니다.

**주요 구성 요소:**
- **엔티티 (Entity)**: 사각형으로 표현, 테이블에 대응
- **속성 (Attribute)**: 타원으로 표현, 컬럼에 대응
- **관계 (Relationship)**: 마름모로 표현, FK 관계에 대응
- **카디널리티**: 1:1, 1:N, M:N 관계 표시

---

### 3.2. 엔티티 목록

```
┌──────────┐
│  Users   │  사용자
└──────────┘

┌──────────┐
│  Posts   │  게시물
└──────────┘

┌──────────┐
│  Media   │  미디어
└──────────┘

┌──────────┐
│ Comments │  댓글
└──────────┘

┌──────────┐
│  Likes   │  좋아요
└──────────┘
```

---

### 3.3. 관계 다이어그램 (텍스트 표현)

```
┌──────────┐                  ┌──────────┐
│  Users   │                  │  Posts   │
│          │──────작성────────>│          │
│ user_id  │     (1:N)        │ post_id  │
└──────────┘                  └──────────┘
     │                              │
     │                              │
     │ 작성 (1:N)                   │ 포함 (1:N)
     │                              │
     ▼                              ▼
┌──────────┐                  ┌──────────┐
│ Comments │                  │  Media   │
│          │                  │          │
│comment_id│                  │ media_id │
└──────────┘                  └──────────┘


┌──────────┐         ┌──────────┐         ┌──────────┐
│  Users   │         │  Likes   │         │  Posts   │
│          │<────────│          │────────>│          │
│ user_id  │  (1:N)  │ like_id  │  (N:1)  │ post_id  │
└──────────┘         └──────────┘         └──────────┘
```

---

### 3.4. 관계 요약

| 관계 | 엔티티 1 | 카디널리티 | 엔티티 2 | 설명 |
|------|----------|------------|----------|------|
| 작성 | Users | 1:N | Posts | 한 사용자는 여러 게시물 작성 |
| 포함 | Posts | 1:N | Media | 한 게시물은 여러 미디어 포함 |
| 작성 | Users | 1:N | Comments | 한 사용자는 여러 댓글 작성 |
| 달림 | Posts | 1:N | Comments | 한 게시물에 여러 댓글 달림 |
| 누름 | Users | 1:N | Likes | 한 사용자는 여러 좋아요 누름 |
| 받음 | Posts | 1:N | Likes | 한 게시물은 여러 좋아요 받음 |

---

## 4. 논리적 ERD

### 4.1. Users (사용자)

```
┌─────────────────────────────────────┐
│              Users                  │
├─────────────────────────────────────┤
│ PK  user_id          INT            │
│     username         VARCHAR(50)    │ UNIQUE
│     email            VARCHAR(100)   │ UNIQUE
│     password_hash    VARCHAR(255)   │
│     full_name        VARCHAR(100)   │ NULL
│     profile_image_url VARCHAR(255)  │ NULL
│     created_at       TIMESTAMP      │
│     updated_at       TIMESTAMP      │
└─────────────────────────────────────┘
```

**키:**
- PK: user_id
- UNIQUE: username, email

---

### 4.2. Posts (게시물)

```
┌─────────────────────────────────────┐
│              Posts                  │
├─────────────────────────────────────┤
│ PK  post_id          INT            │
│ FK  user_id          INT            │ → Users.user_id
│     content          TEXT           │ NULL
│     created_at       TIMESTAMP      │
│     updated_at       TIMESTAMP      │
└─────────────────────────────────────┘
```

**키:**
- PK: post_id
- FK: user_id → Users.user_id

**관계:**
- Users (1) ──< Posts (N)

**참조 무결성:**
- ON DELETE CASCADE
- ON UPDATE CASCADE

---

### 4.3. Media (미디어)

```
┌─────────────────────────────────────┐
│              Media                  │
├─────────────────────────────────────┤
│ PK  media_id         INT            │
│ FK  post_id          INT            │ → Posts.post_id
│     media_url        VARCHAR(255)   │
│     media_type       ENUM('IMAGE','VIDEO') │
│     media_order      TINYINT        │ 1~10
│     created_at       TIMESTAMP      │
└─────────────────────────────────────┘
```

**키:**
- PK: media_id
- FK: post_id → Posts.post_id

**관계:**
- Posts (1) ──< Media (N)

**참조 무결성:**
- ON DELETE CASCADE
- ON UPDATE CASCADE

---

### 4.4. Comments (댓글)

```
┌─────────────────────────────────────┐
│            Comments                 │
├─────────────────────────────────────┤
│ PK  comment_id       INT            │
│ FK  post_id          INT            │ → Posts.post_id
│ FK  user_id          INT            │ → Users.user_id
│     content          VARCHAR(500)   │
│     created_at       TIMESTAMP      │
│     updated_at       TIMESTAMP      │
└─────────────────────────────────────┘
```

**키:**
- PK: comment_id
- FK: post_id → Posts.post_id
- FK: user_id → Users.user_id

**관계:**
- Posts (1) ──< Comments (N)
- Users (1) ──< Comments (N)

**참조 무결성:**
- post_id: ON DELETE CASCADE
- user_id: ON DELETE CASCADE

---

### 4.5. Likes (좋아요)

```
┌─────────────────────────────────────┐
│              Likes                  │
├─────────────────────────────────────┤
│ PK  like_id          INT            │
│ FK  post_id          INT            │ → Posts.post_id
│ FK  user_id          INT            │ → Users.user_id
│     created_at       TIMESTAMP      │
└─────────────────────────────────────┘
```

**키:**
- PK: like_id
- FK: post_id → Posts.post_id
- FK: user_id → Users.user_id

**관계:**
- Posts (1) ──< Likes (N)
- Users (1) ──< Likes (N)

**참조 무결성:**
- ON DELETE CASCADE (게시물/사용자 삭제 시 좋아요도 삭제)
- ON UPDATE CASCADE
